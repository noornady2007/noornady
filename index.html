<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SHAHDâ™¡NOOR</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>

.love-text{
  position:absolute;
  font-size:15px;
  color:#ffd6ff;
  font-weight:700;
  opacity:0;
  animation:loveFloat 2.5s ease forwards;
  pointer-events:none;
  white-space:nowrap;
}

@keyframes loveFloat{
  0%{opacity:0;transform:translateY(0) scale(.9)}
  20%{opacity:1}
  100%{opacity:0;transform:translateY(-120px) scale(1.1)}
}
  
:root{
  --bg1:#3c096c;
  --bg2:#5a189a;
  --bg3:#240046;
  --glass:rgba(255,255,255,.16);
  --text:#fff;
  --btn:#e0aaff;
  --btnText:#240046;
}

body{
  margin:0;
  font-family:'Cairo',sans-serif;
  color:var(--text);
  min-height:100vh;
  background:
    radial-gradient(circle at top left,#7b2cbf55,transparent 45%),
    radial-gradient(circle at bottom right,#ffafcc33,transparent 45%),
    linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  transition:background 1s ease;
}

/* ğŸŒ Light */
body.light{
  --bg1:#ffe5ff;
  --bg2:#e0aaff;
  --bg3:#c77dff;
  --text:#3c096c;
}

/* ===== Header ===== */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px;
}

.icon-btn{
  width:42px;height:42px;
  border-radius:14px;
  background:rgba(255,255,255,.25);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}

.header-title{
  font-weight:700;
  font-size:20px;
}

/* ===== Containers ===== */
.container{
  max-width:430px;
  margin:auto;
  padding:16px;
}

.hidden{display:none}

input,textarea,button{
  width:100%;
  padding:14px;
  margin:8px 0;
  border-radius:14px;
  border:none;
  font-family:inherit;
}

input,textarea{
  background:rgba(255,255,255,.25);
  color:#fff;
}

button{
  background:var(--btn);
  color:var(--btnText);
  font-weight:700;
}

/* ===== Add Box ===== */
#addBox{
  overflow:hidden;
  transition:.6s ease;
}
#addBox.hide{max-height:0;opacity:0;transform:translateY(-20px)}
#addBox.show{max-height:500px;opacity:1;transform:translateY(0)}

/* ===== Cards ===== */
.card{
  background:var(--glass);
  backdrop-filter:blur(18px);
  border-radius:20px;
  padding:12px;
  margin-top:18px;
  animation:fadeIn .8s ease;
}

@keyframes fadeIn{
  from{opacity:0;transform:scale(.95)}
  to{opacity:1;transform:scale(1)}
}

.card img{
  width:100%;
  border-radius:14px;
  cursor:pointer;
  transition:.4s ease;
}
.card img:hover{
  filter:blur(1px);
  transform:scale(1.02);
}

/* ===== Actions ===== */
.actions{
  display:flex;
  gap:8px;
  margin-top:8px;
}
.action-btn{
  width:36px;height:36px;
  border-radius:12px;
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}

/* ===== Viewer ===== */
.viewer{
  position:fixed;
  inset:0;
  background:#000c;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:100;
}
.viewer img{
  max-width:90%;
  max-height:90%;
  border-radius:20px;
}

/* â¤ï¸ Heart */
.heart{
  position:absolute;
  color:#ff4d6d;
  font-size:24px;
  animation:heart 1.5s ease forwards;
}
@keyframes heart{
  0%{opacity:1;transform:translateY(0) scale(1)}
  100%{opacity:0;transform:translateY(-80px) scale(1.6)}
}
</style>
</head>

<body>

<div class="header">
  <div class="icon-btn" onclick="toggleTheme()">ğŸŒ™</div>
  <div class="header-title">SHAHDâ™¡NOOR ğŸ’œ</div>
  <div class="icon-btn" onclick="toggleAdd()">â‹®</div>
</div>

<div id="login" class="container">
  <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="app" class="container hidden">

  <div id="addBox" class="hide">
    <input type="file" id="image" accept="image/*">
    <input type="date" id="date">
    <textarea id="desc" placeholder="ÙˆØµÙ Ø§Ù„ØµÙˆØ±Ø©"></textarea>
    <button onclick="addPhoto()">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø©</button>
  </div>

  <div id="gallery"></div>
</div>

<audio id="likeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-soft-click-tone-1112.mp3"></audio>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBuSYBywG6Jn-pTaqkKEDcbYeORukEh1pU",
  authDomain: "noor-25be7.firebaseapp.com",
  projectId: "noor-25be7",
  storageBucket: "noor-25be7.firebasestorage.app",
  messagingSenderId: "245021407626",
  appId: "1:245021407626:web:e4ce8a4d4a5a160831b073"
};

const appFirebase = initializeApp(firebaseConfig);
const db = getFirestore(appFirebase);

const REAL_PASSWORD="25102007";
const loginDiv=document.getElementById("login");
const app=document.getElementById("app");
const gallery=document.getElementById("gallery");
const addBox=document.getElementById("addBox");

window.login=()=>{
  if(password.value===REAL_PASSWORD){
    loginDiv.classList.add("hidden");
    app.classList.remove("hidden");
    loadPhotos();
  }else alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙ„Ø·");
}

window.toggleAdd=()=>{
  addBox.classList.toggle("show");
  addBox.classList.toggle("hide");
}

window.toggleTheme=()=>{
  document.body.classList.toggle("light");
  localStorage.theme=document.body.classList.contains("light")?"light":"dark";
}

if(localStorage.theme==="light") document.body.classList.add("light");

/* ğŸ§  Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø°ÙƒÙŠ */
const hour=new Date().getHours();
if(hour>=6 && hour<18) document.body.classList.add("light");

window.addPhoto=()=>{
  const file=image.files[0];
  if(!file) return alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø©");
  const r=new FileReader();
  r.onload=async()=>{
    await addDoc(collection(db,"images"),{
      img:r.result,
      date:date.value,
      desc:desc.value,
      createdAt:Date.now()
    });
    image.value="";date.value="";desc.value="";
    loadPhotos();
  };
  r.readAsDataURL(file);
}

async function loadPhotos(){
  gallery.innerHTML="";
  const q=query(collection(db,"images"),orderBy("createdAt","desc"));
  const snap=await getDocs(q);
  snap.forEach(d=>{
    const p=d.data();
    gallery.innerHTML+=`
    <div class="card">
      <img src="${p.img}" onclick="like(event,'${p.img}')">
      <div>ğŸ“… ${p.date||""}</div>
      <div>${p.desc||""}</div>
      <div class="actions">
        <div class="action-btn" onclick="editPhoto('${d.id}')">âœï¸</div>
        <div class="action-btn" onclick="deletePhoto('${d.id}')">ğŸ—‘</div>
      </div>
    </div>`;
  });
}

window.like=(e,src)=>{
  document.getElementById("likeSound").play();
  const h=document.createElement("div");
  h.className="heart";
  h.style.left=e.pageX+"px";
  h.style.top=e.pageY+"px";
  h.innerHTML="â¤";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),1500);
  openImg(src);
}

window.openImg=src=>{
  const v=document.createElement("div");
  v.className="viewer";
  v.innerHTML=`<img src="${src}">`;
  v.onclick=()=>v.remove();
  document.body.appendChild(v);
}

window.deletePhoto=async id=>{
  if(prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±")!==REAL_PASSWORD) return;
  await deleteDoc(doc(db,"images",id));
  loadPhotos();
}

window.editPhoto=async id=>{
  if(prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±")!==REAL_PASSWORD) return;
  const d=prompt("Ø§Ù„ÙˆØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯");
  const dt=prompt("Ø§Ù„ØªØ§Ø±ÙŠØ®");
  await updateDoc(doc(db,"images",id),{desc:d,date:dt});
  loadPhotos();
}
</script>

</body>
</html>
